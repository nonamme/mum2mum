<!DOCTYPE html>
<html>
  <head>
    <title>M2M</title>
    <%= csrf_meta_tags %>
    <%= stylesheet_link_tag "application" %>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="//maps.googleapis.com/maps/api/js?key=AIzaSyAItQXA7a3VvCT7aWhXznumwM21XERS_B4"></script>
    <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>
    <script src='//cdn.rawgit.com/printercu/google-maps-utility-library-v3-read-only/master/infobox/src/infobox_packed.js' type='text/javascript'></script>
</head>

<body id="<%= removeSlash request.original_fullpath%>">
    <div id="notes" class="notes">
    <% if flash[:notice] %>
      <div id="notice" class="notice"> <%= flash[:notice] %> </div>
    <% elsif flash[:error] %>
      <div id="error" class="error"> <%= flash[:error] %> </div>
    <% end %>
    </div>
    <%= render 'partials/menu' if session[:id] == nil %>
    <%= yield %>
    <%= javascript_include_tag 'application' %>
    <script type="text/javascript">
   handler = Gmaps.build('Google');
   handler.buildMap({ provider: { 
     disableDefaultUI: true,
     minZoom: 3,
     maxZoom: 13,
     zoom: 8,
     center: { lat: 54.0000, lng: -2.0000 },
     mapTypeId: 'roadmap'
   }, internal: {id: 'map'}}, function(){
     markers = handler.addMarkers(<%=raw @hash.to_json %>);
      handler.bounds.extendWith(markers);
    }); 
  </script>
  </body>
</html>
